import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as p,o as i,c as o,b as n,d as s,a as e,e as c}from"./app-21d4bb55.js";const l={},r=n("h2",{id:"引入",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#引入","aria-hidden":"true"},"#"),s(" 引入")],-1),d=n("p",null,[s("Pixiv 在大陆被墙，并且图片服务器域名"),n("code",null,"i.pximg.net"),s("有盗链保护，只要Referer不是来自Pixiv的请求都会返回403。那么，如何才能在大陆地区直接访问图片资源？这就需要用到代理服务了√")],-1),u={href:"https://api.lolicon.app/",target:"_blank",rel:"noopener noreferrer"},k={href:"https://www.acgmx.com/",target:"_blank",rel:"noopener noreferrer"},v=n("h2",{id:"第三方代理",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#第三方代理","aria-hidden":"true"},"#"),s(" 第三方代理")],-1),h=n("p",null,[s("不会自己搭建的话，可以直接使用第三方服务。"),n("code",null,"pixiv.cat"),s("就是一个专门用于p站图片代理的站点，甚至能直接通过图片id请求获取插画。不过呢，最近大陆被墙掉了，就没办法访问哩。")],-1),m=n("p",null,"如果有需要，也是可以使用别人的代理的啦，如果别人同意的话~",-1),_=n("h2",{id:"官方代理",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#官方代理","aria-hidden":"true"},"#"),s(" 官方代理")],-1),b=n("code",null,"i-cf.pximg.net",-1),x={href:"https://steampp.net/",target:"_blank",rel:"noopener noreferrer"},f=c(`<h2 id="反向代理" tabindex="-1"><a class="header-anchor" href="#反向代理" aria-hidden="true">#</a> 反向代理</h2><p>如果有自己的服务器，可以使用nginx进行反向代理：</p><div class="language-nginx line-numbers-mode" data-ext="nginx"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">proxy_cache_path</span> /path/to/cache levels=1:2 keys_zone=pximg:10m max_size=10g inactive=7d use_temp_path=off</span><span class="token punctuation">;</span>

<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">443</span> ssl http2</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">ssl_certificate</span> /path/to/ssl_certificate.crt</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">ssl_certificate_key</span> /path/to/ssl_certificate.key</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">server_name</span> i.pixiv.cat</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">access_log</span> <span class="token boolean">off</span></span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">proxy_cache</span> pximg</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_pass</span> https://i.pximg.net</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_cache_revalidate</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_cache_use_stale</span> error timeout updating http_500 http_502 http_503 http_504</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_cache_lock</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">add_header</span> X-Cache-Status <span class="token variable">$upstream_cache_status</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> Host i.pximg.net</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_set_header</span> Referer <span class="token string">&quot;https://www.pixiv.net/&quot;</span></span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">proxy_cache_valid</span> <span class="token number">200</span> <span class="token number">7d</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_cache_valid</span> <span class="token number">404</span> <span class="token number">5m</span></span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>没有服务器也没关系，可以利用Cloudflare的Workers白嫖，每日免费提供10万次请求，完全满足日常使用。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token parameter">request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> someHost <span class="token operator">=</span> <span class="token string">&#39;i.pximg.net&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> someUrl <span class="token operator">=</span> <span class="token string">&#39;https://www.pixiv.net/&#39;</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    url<span class="token punctuation">.</span>hostname <span class="token operator">=</span> someHost<span class="token punctuation">;</span>

    <span class="token keyword">const</span> requestInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    requestInfo<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&#39;Referer&#39;</span><span class="token punctuation">,</span> someUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span>requestInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="开始涩涩" tabindex="-1"><a class="header-anchor" href="#开始涩涩" aria-hidden="true">#</a> 开始涩涩</h2><p>配置相关 DNS 解析后，就可以直接通过 URL 直接访问 p 站图片了。</p><p>Pixiv网站上的（直接打开或在其他网站使用会返回403，在Markdown中直接不显示）</p><figure><img src="https://i.pximg.net/img-master/img/2021/06/10/18/09/04/90457556_p0_master1200.jpg" alt="原始链接" tabindex="0" loading="lazy"><figcaption>原始链接</figcaption></figure>`,9),g={href:"http://pixiv.yuki.sh",target:"_blank",rel:"noopener noreferrer"},y=n("img",{src:"https://pixiv.yuki.sh/img-master/img/2021/06/10/18/09/04/90457556_p0_master1200.jpg",width:"40%"},null,-1),w=n("h1",{id:"参考文章",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#参考文章","aria-hidden":"true"},"#"),s(" 参考文章")],-1),P={href:"https://blog.yuki.sh/posts/c43574a3d7b9/",target:"_blank",rel:"noopener noreferrer"};function q(I,R){const a=p("ExternalLinkIcon");return i(),o("div",null,[r,d,n("p",null,[s("不建议直接搭建反代站，容易遭到P站发邮件到您的主机商投诉，甚至还会导致VPS服务等被终止。有一些涩图API，比如"),n("a",u,[s("lolicon"),e(a)]),s("和"),n("a",k,[s("Acgmx"),e(a)]),s("，返回的都是Pixiv官方图片链接，并不能直接访问，所以便有了单独针对图片代理的需求。")]),v,h,m,_,n("p",null,[s("是的，官方其实是有一个反代地址的，只针对于图片用的："),b,s("，可是就算把链接替换成了官方的依旧无法访问，怎么办呢？当然是使用我认为最好用的一个软件："),n("a",x,[s("Steam++"),e(a)]),s("，进去以后到最下面，就可以看到给P站进行图片代理了~直接打开就可以正常访问啦！")]),f,n("p",null,[s("反向代理的可以正常访问（"),n("a",g,[s("pixiv.yuki.sh"),e(a)]),s("）：")]),y,w,n("ul",null,[n("li",null,[n("a",P,[s("Pixiv 图片反向代理"),e(a)])])])])}const S=t(l,[["render",q],["__file","Pixiv图片反向代理.html.vue"]]);export{S as default};
